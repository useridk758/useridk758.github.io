<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="os-title">NEBULA OS</title>
    <link id="os-favicon" rel="icon" href="https://cdn-icons-png.flaticon.com/512/606/606547.png">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@900&display=swap" rel="stylesheet">
    
    <style>
        :root { --theme-main: #3b82f6; --ease: cubic-bezier(0.2, 1, 0.2, 1); --m-x: 0; --m-y: 0; }
        * { margin: 0; padding: 0; box-sizing: border-box; cursor: none !important; font-style: normal !important; transition: all 0.5s var(--ease); }
        body { background: #000; color: #fff; font-family: 'Inter', sans-serif; overflow: hidden; height: 100vh; }

        /* --- LOADING / UPDATE SCREEN --- */
        #update-screen { display: none; opacity: 0; transform: scale(1.1); }
        .progress-bar { width: 100%; height: 4px; background: rgba(255,255,255,0.1); border-radius: 10px; overflow: hidden; margin-top: 20px; }
        .progress-fill { width: 0%; height: 100%; background: var(--theme-main); }

        /* --- HUD (TOP MENU) --- */
        #hud { position: fixed; top: -100px; left: 50%; transform: translateX(-50%); z-index: 6000; background: rgba(10,10,10,0.8); backdrop-filter: blur(20px); padding: 10px 30px; border-radius: 0 0 20px 20px; border: 1px solid rgba(255,255,255,0.1); border-top: none; display: flex; gap: 40px; }
        #hud.active { top: 0; }
        .hud-btn { font-size: 10px; font-weight: 900; letter-spacing: 2px; color: #fff; opacity: 0.5; }
        .hud-btn:hover { opacity: 1; color: var(--theme-main); }

        /* --- GAMES GRID --- */
        .game-card { width: 100%; aspect-ratio: 1; background: #111; border-radius: 15px; overflow: hidden; border: 1px solid #222; position: relative; }
        .game-card:hover { transform: translateY(-10px); border-color: var(--theme-main); box-shadow: 0 20px 40px rgba(0,0,0,0.5); }
        .game-card img { width: 100%; height: 100%; object-fit: cover; opacity: 0.6; }

        /* --- UI ELEMENTS --- */
        .layer { position: fixed; inset: 0; z-index: 9000; display: none; align-items: center; justify-content: center; opacity: 0; background: rgba(0,0,0,0.95); backdrop-filter: blur(60px); }
        .layer.active { display: flex; opacity: 1; }
        .hero { font-size: 15vw; font-weight: 900; text-transform: uppercase; text-align: center; line-height: 0.9; background: linear-gradient(180deg, #fff 40%, #333 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; filter: drop-shadow(0 0 50px rgba(59,130,246,0.3)); }
        
        #workspace { position: fixed; inset: 0; z-index: 5000; display: none; }
        #workspace iframe { width: 100%; height: 100%; border: none; }
        
        #c-dot { position: fixed; width: 6px; height: 6px; background: #fff; border-radius: 50%; z-index: 10000; pointer-events: none; transform: translate3d(var(--m-x), var(--m-y), 0); transition: none; }
    </style>
</head>
<body>

    <canvas id="stars" class="fixed inset-0 -z-10"></canvas>
    <div id="c-dot"></div>

    <div id="hud">
        <button class="hud-btn" onclick="OS.goHome()">EXIT WORKSPACE</button>
        <button class="hud-btn" onclick="OS.openLayer('search-layer')">NEW SEARCH</button>
        <button class="hud-btn" onclick="OS.openLayer('games-layer')">GAMES LIBRARY</button>
    </div>

    <div id="gate" class="fixed inset-0 flex items-center justify-center z-[10000] bg-black">
        <input type="text" id="user-in" class="bg-transparent border-none text-8xl font-black text-center outline-none w-full placeholder-white/5" placeholder="NAME" onkeypress="if(event.key==='Enter')OS.startUpdate()">
    </div>

    <div id="update-screen" class="fixed inset-0 flex flex-col items-center justify-center z-[10000] bg-black px-20">
        <div class="w-full max-w-3xl">
            <h2 class="text-4xl font-black mb-2">NEBULA_OS CORE</h2>
            <p id="update-status" class="text-blue-500 font-bold tracking-widest text-xs uppercase">Initializing Kernel...</p>
            <div class="progress-bar"><div id="p-fill" class="progress-fill"></div></div>
            <div class="mt-10 grid grid-cols-2 gap-10 text-[10px] text-white/20 font-black uppercase">
                <div>Memory: 64GB Virtual<br>GPU: WebGL_Accelerated<br>Location: <span id="loc">Detecting...</span></div>
                <div class="text-right">Security: Proxy_Active<br>Encryption: AES_256<br>Status: Deployment</div>
            </div>
        </div>
    </div>

    <main id="desktop" class="absolute inset-0 flex items-center justify-center opacity-0 scale-90 pointer-events-none">
        <h1 class="hero">NEBULA</h1>
    </main>

    <div id="workspace"><iframe id="browser-frame" src=""></iframe></div>

    <div id="games-layer" class="layer" onclick="OS.closeAll()">
        <div class="w-full max-w-5xl px-10" onclick="event.stopPropagation()">
            <h2 class="text-center text-4xl font-black mb-12 tracking-tighter">GAMES_ARCHIVE</h2>
            <div class="grid grid-cols-4 gap-6 overflow-y-auto max-h-[70vh] pr-4" id="games-grid">
                </div>
        </div>
    </div>

    <div id="search-layer" class="layer" onclick="OS.closeAll()">
        <div class="w-full max-w-4xl text-center" onclick="event.stopPropagation()">
            <h1 style="font-size: 120px; color: white; font-weight: 900; line-height: 0.8; margin-bottom: 50px;">NEBU<br>PR*XY</h1>
            <input type="text" id="search-field" class="bg-[#111] border border-[#222] w-full max-w-2xl p-6 rounded-full text-center outline-none text-xl font-bold" placeholder="SEARCH THE VOID" onkeypress="if(event.key==='Enter')OS.runSearch()">
        </div>
    </div>

    <div id="dock-wrap" class="fixed bottom-[-100px] left-1/2 -translate-x-1/2 z-[5500]">
        <div class="flex gap-4 p-2 bg-white/5 border border-white/10 rounded-[22px] backdrop-blur-3xl">
            <div class="w-[42px] h-[42px] bg-[#0a0a0a] rounded-xl flex items-center justify-center text-sm" onclick="OS.goHome()">üè†</div>
            <div class="w-[42px] h-[42px] bg-[#0a0a0a] rounded-xl flex items-center justify-center text-sm" onclick="OS.openLayer('search-layer')">üîç</div>
            <div class="w-[42px] h-[42px] bg-[#0a0a0a] rounded-xl flex items-center justify-center text-sm" onclick="OS.openLayer('games-layer')">üéÆ</div>
            <div class="w-[42px] h-[42px] bg-[#0a0a0a] rounded-xl flex items-center justify-center text-sm" onclick="OS.openLayer('settings-layer')">‚öôÔ∏è</div>
        </div>
    </div>

    <script>
        const GAMES = [
            { n: "A-DRIFT", u: "https://html5games.com/game/Drift-Hunters", i: "https://images.crazygames.com/drift-hunters/20240222101413/drift-hunters-cover?auto=format,compress&q=75&cs=strip&ch=DPR&w=1200" },
            { n: "B-BASKET", u: "https://html5games.com/game/Basketball-Stars", i: "https://play-lh.googleusercontent.com/9783D-wI30mC-Q5v-f2X9-qA7W6mG7-hGvYhM_6V6O-t1S9_J8_G_8" },
            { n: "C-CROSSY", u: "https://crossyroad.com", i: "https://images.crazygames.com/crossy-road/20201026111306/crossy-road-cover?auto=format,compress&q=75&cs=strip&ch=DPR&w=1200" },
            { n: "D-DOOM", u: "https://dos.zone/doom-dec-1993/", i: "https://upload.wikimedia.org/wikipedia/en/5/57/Doom_cover_art.jpg" }
        ];

        class NebulaOS {
            constructor() { this.init(); }

            init() {
                window.onmousemove = (e) => {
                    document.documentElement.style.setProperty('--m-x', `${e.clientX}px`);
                    document.documentElement.style.setProperty('--m-y', `${e.clientY}px`);
                };
                this.setupStars();
                this.loadGames();
            }

            startUpdate() {
                const name = document.getElementById('user-in').value || "USER";
                document.getElementById('gate').style.opacity = '0';
                setTimeout(() => {
                    document.getElementById('gate').style.display = 'none';
                    const screen = document.getElementById('update-screen');
                    screen.style.display = 'flex';
                    setTimeout(() => screen.style.opacity = '1', 10);
                    
                    let p = 0;
                    const interval = setInterval(() => {
                        p += Math.random() * 5;
                        if(p >= 100) {
                            p = 100; clearInterval(interval);
                            this.finishBoot();
                        }
                        document.getElementById('p-fill').style.width = p + '%';
                        document.getElementById('update-status').innerText = p < 30 ? "MOUNTING DRIVES..." : p < 70 ? "OPTIMIZING PROXY NODES..." : "READY TO LAUNCH";
                    }, 100);
                }, 800);
            }

            finishBoot() {
                setTimeout(() => {
                    document.getElementById('update-screen').style.opacity = '0';
                    setTimeout(() => {
                        document.getElementById('update-screen').style.display = 'none';
                        document.getElementById('desktop').style.opacity = '1';
                        document.getElementById('desktop').style.transform = 'scale(1)';
                        document.getElementById('dock-wrap').style.bottom = '30px';
                    }, 800);
                }, 500);
            }

            loadGames() {
                const grid = document.getElementById('games-grid');
                GAMES.forEach(g => {
                    const div = document.createElement('div');
                    div.className = "game-card";
                    div.innerHTML = `<img src="${g.i}"><div class="absolute inset-0 flex items-center justify-center font-black text-xs">${g.n}</div>`;
                    div.onclick = () => this.runSearch(g.u);
                    grid.appendChild(div);
                });
            }

            runSearch(url) {
                let v = url || document.getElementById('search-field').value;
                if(!v) return;
                v = v.includes('.') ? (v.startsWith('http') ? v : 'https://' + v) : 'https://www.google.com/search?q=' + encodeURIComponent(v);
                document.getElementById('browser-frame').src = v;
                document.getElementById('workspace').style.display = 'block';
                document.getElementById('dock-wrap').style.bottom = '-100px';
                document.getElementById('hud').classList.add('active');
                this.closeAll();
            }

            goHome() {
                document.getElementById('workspace').style.display = 'none';
                document.getElementById('browser-frame').src = "";
                document.getElementById('dock-wrap').style.bottom = '30px';
                document.getElementById('hud').classList.remove('active');
            }

            openLayer(id) {
                this.closeAll();
                const el = document.getElementById(id);
                el.style.display = 'flex';
                setTimeout(() => el.classList.add('active'), 10);
            }

            closeAll() {
                document.querySelectorAll('.layer').forEach(l => {
                    l.classList.remove('active');
                    setTimeout(() => { if(!l.classList.contains('active')) l.style.display = 'none'; }, 500);
                });
            }

            setupStars() {
                const c = document.getElementById('stars'); const ctx = c.getContext('2d');
                let pts = []; const res = () => { c.width = window.innerWidth; c.height = window.innerHeight; };
                window.onresize = res; res();
                for(let i=0; i<150; i++) pts.push({x: Math.random()*c.width, y: Math.random()*c.height, s: Math.random()*2});
                const draw = () => {
                    ctx.clearRect(0,0,c.width,c.height); ctx.fillStyle = '#fff';
                    pts.forEach(p => { ctx.beginPath(); ctx.arc(p.x, p.y, p.s, 0, Math.PI*2); ctx.fill(); p.y += 0.15; if(p.y > c.height) p.y = 0; });
                    requestAnimationFrame(draw);
                };
                draw();
            }
        }
        const OS = new NebulaOS();
    </script>
</body>
</html>
